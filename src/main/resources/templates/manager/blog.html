<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml"  lang="zh">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>博客管理 - Sunly's Garden</title>
  <link rel="icon" href="../../static/manager/favicon.ico" th:href="@{~/manager/favicon.ico}" type="image/ico">
  <meta name="keywords" content="Sunly's,Sunly's Garden">
  <meta name="description" content="Sunly的个人博客">
  <meta name="author" content="Sunly">
  <link href="../../static/manager/css/bootstrap.min.css" th:href="@{~/manager/css/bootstrap.min.css}" rel="stylesheet">
  <link href="../../static/manager/css/materialdesignicons.min.css" th:href="@{~/manager/css/materialdesignicons.min.css}" rel="stylesheet">
  <link href="../../static/manager/css/style.min.css" th:href="@{~/manager/css/style.min.css}" rel="stylesheet">
  <style>
    td{
      vertical-align: middle !important;
      text-align: center;
    }
  </style>
</head>
  
<body>
<div class="lyear-layout-web">
  <div class="lyear-layout-container">
    <!--左侧导航-->
    <aside class="lyear-layout-sidebar">
      <!-- logo -->
      <div id="logo" class="sidebar-header">
        <a href="index.html" th:href="@{/home/index}"><img src="../../static/manager/images/logo-sidebar.png" th:src="@{~/manager/images/logo-sidebar.png}" title="Sunly's Garden" alt="Sunly's Garden" /></a>
      </div>
      <div class="lyear-layout-sidebar-scroll">
        <nav class="sidebar-main">
          <ul class="nav nav-drawer">
            <li class="nav-item"> <a href="#" th:href="@{/manager/index}"><i class="mdi mdi-home"></i> 后台首页</a> </li>
            <li class="nav-item"> <a href="#" th:href="@{/manager/user}"><i class="mdi mdi-human-greeting"></i> 用户管理</a> </li>
            <li class="nav-item nav-item-has-subnav active open">
              <a href="javascript:void(0)"><i class="mdi mdi-blogger"></i> 博文管理</a>
              <ul class="nav nav-subnav">
                <li> <a href="#" th:href="@{/manager/article-category}">博文类型</a> </li>
                <li class="active"> <a href="#" th:href="@{/manager/article}">博文列表</a> </li>
              </ul>
            </li>
            <li class="nav-item"> <a href="#" th:href="@{/manager/link}"><i class="mdi mdi-link-variant"></i> 友链管理</a> </li>
            <li class="nav-item"> <a href="#" th:href="@{/manager/message}"><i class="mdi mdi-message-processing"></i> 留言管理</a> </li>
            <li class="nav-item"> <a href="#" th:href="@{/manager/diary}"><i class="mdi mdi-file-document"></i> 日记管理</a> </li>
          </ul>
        </nav>
      </div>
    </aside>
    <!--End 左侧导航-->
    
    <!--头部信息-->
    <header class="lyear-layout-header">
      
      <nav class="navbar navbar-default">
        <div class="topbar">
          
          <div class="topbar-left">
            <div class="lyear-aside-toggler">
              <span class="lyear-toggler-bar"></span>
              <span class="lyear-toggler-bar"></span>
              <span class="lyear-toggler-bar"></span>
            </div>
            <span class="navbar-page-title"> 博客管理 </span>
          </div>
          
          <ul class="topbar-right">
            <li class="dropdown dropdown-profile">
              <a href="javascript:void(0)" data-toggle="dropdown">
                <img class="img-avatar img-avatar-48 m-r-10" src="../../static/manager/images/users/avatar.jpg" th:src="@{~/manager/images/users/avatar.jpg}" alt="Sunly" />
                <span>Sunly <span class="caret"></span></span>
              </a>
              <ul class="dropdown-menu dropdown-menu-right">
                <li> <a href="#"><i class="mdi mdi-account"></i> 个人信息</a> </li>
                <li> <a href="#"><i class="mdi mdi-lock-outline"></i> 修改密码</a> </li>
                <li> <a href="javascript:void(0)"><i class="mdi mdi-delete"></i> 清空缓存</a></li>
                <li class="divider"></li>
                <li> <a href="#"><i class="mdi mdi-logout-variant"></i> 退出登录</a> </li>
              </ul>
            </li>
            <!--切换主题配色-->
		    <li class="dropdown dropdown-skin">
			  <span data-toggle="dropdown" class="icon-palette"><i class="mdi mdi-palette"></i></span>
			  <ul class="dropdown-menu dropdown-menu-right" data-stopPropagation="true">
                <li class="drop-title"><p>主题</p></li>
                <li class="drop-skin-li clearfix">
                  <span class="inverse">
                    <input type="radio" name="site_theme" value="default" id="site_theme_1" checked>
                    <label for="site_theme_1"></label>
                  </span>
                  <span>
                    <input type="radio" name="site_theme" value="dark" id="site_theme_2">
                    <label for="site_theme_2"></label>
                  </span>
                  <span>
                    <input type="radio" name="site_theme" value="translucent" id="site_theme_3">
                    <label for="site_theme_3"></label>
                  </span>
                </li>
			    <li class="drop-title"><p>LOGO</p></li>
				<li class="drop-skin-li clearfix">
                  <span class="inverse">
                    <input type="radio" name="logo_bg" value="default" id="logo_bg_1" checked>
                    <label for="logo_bg_1"></label>
                  </span>
                  <span>
                    <input type="radio" name="logo_bg" value="color_2" id="logo_bg_2">
                    <label for="logo_bg_2"></label>
                  </span>
                  <span>
                    <input type="radio" name="logo_bg" value="color_3" id="logo_bg_3">
                    <label for="logo_bg_3"></label>
                  </span>
                  <span>
                    <input type="radio" name="logo_bg" value="color_4" id="logo_bg_4">
                    <label for="logo_bg_4"></label>
                  </span>
                  <span>
                    <input type="radio" name="logo_bg" value="color_5" id="logo_bg_5">
                    <label for="logo_bg_5"></label>
                  </span>
                  <span>
                    <input type="radio" name="logo_bg" value="color_6" id="logo_bg_6">
                    <label for="logo_bg_6"></label>
                  </span>
                  <span>
                    <input type="radio" name="logo_bg" value="color_7" id="logo_bg_7">
                    <label for="logo_bg_7"></label>
                  </span>
                  <span>
                    <input type="radio" name="logo_bg" value="color_8" id="logo_bg_8">
                    <label for="logo_bg_8"></label>
                  </span>
				</li>
				<li class="drop-title"><p>头部</p></li>
				<li class="drop-skin-li clearfix">
                  <span class="inverse">
                    <input type="radio" name="header_bg" value="default" id="header_bg_1" checked>
                    <label for="header_bg_1"></label>                      
                  </span>                                                    
                  <span>                                                     
                    <input type="radio" name="header_bg" value="color_2" id="header_bg_2">
                    <label for="header_bg_2"></label>                      
                  </span>                                                    
                  <span>                                                     
                    <input type="radio" name="header_bg" value="color_3" id="header_bg_3">
                    <label for="header_bg_3"></label>
                  </span>
                  <span>
                    <input type="radio" name="header_bg" value="color_4" id="header_bg_4">
                    <label for="header_bg_4"></label>                      
                  </span>                                                    
                  <span>                                                     
                    <input type="radio" name="header_bg" value="color_5" id="header_bg_5">
                    <label for="header_bg_5"></label>                      
                  </span>                                                    
                  <span>                                                     
                    <input type="radio" name="header_bg" value="color_6" id="header_bg_6">
                    <label for="header_bg_6"></label>                      
                  </span>                                                    
                  <span>                                                     
                    <input type="radio" name="header_bg" value="color_7" id="header_bg_7">
                    <label for="header_bg_7"></label>
                  </span>
                  <span>
                    <input type="radio" name="header_bg" value="color_8" id="header_bg_8">
                    <label for="header_bg_8"></label>
                  </span>
				</li>
				<li class="drop-title"><p>侧边栏</p></li>
				<li class="drop-skin-li clearfix">
                  <span class="inverse">
                    <input type="radio" name="sidebar_bg" value="default" id="sidebar_bg_1" checked>
                    <label for="sidebar_bg_1"></label>
                  </span>
                  <span>
                    <input type="radio" name="sidebar_bg" value="color_2" id="sidebar_bg_2">
                    <label for="sidebar_bg_2"></label>
                  </span>
                  <span>
                    <input type="radio" name="sidebar_bg" value="color_3" id="sidebar_bg_3">
                    <label for="sidebar_bg_3"></label>
                  </span>
                  <span>
                    <input type="radio" name="sidebar_bg" value="color_4" id="sidebar_bg_4">
                    <label for="sidebar_bg_4"></label>
                  </span>
                  <span>
                    <input type="radio" name="sidebar_bg" value="color_5" id="sidebar_bg_5">
                    <label for="sidebar_bg_5"></label>
                  </span>
                  <span>
                    <input type="radio" name="sidebar_bg" value="color_6" id="sidebar_bg_6">
                    <label for="sidebar_bg_6"></label>
                  </span>
                  <span>
                    <input type="radio" name="sidebar_bg" value="color_7" id="sidebar_bg_7">
                    <label for="sidebar_bg_7"></label>
                  </span>
                  <span>
                    <input type="radio" name="sidebar_bg" value="color_8" id="sidebar_bg_8">
                    <label for="sidebar_bg_8"></label>
                  </span>
				</li>
			  </ul>
			</li>
            <!--切换主题配色-->
          </ul>
          
        </div>
      </nav>
      
    </header>
    <!--End 头部信息-->

    <!--页面主要内容-->
    <main class="lyear-layout-content">

      <div class="container-fluid">

        <div class="row">
          <div class="col-lg-12">
            <div class="card">
              <div class="card-toolbar clearfix">
                <div class="toolbar-btn-action">
                  <button type="button" class="btn btn-primary m-r-5" id="addModal"><i class="mdi mdi-plus"></i>新增</button>
                </div>
              </div>
              <div class="card-body">
                <div class="table-responsive">
                  <table class="table table-bordered">
                    <thead>
                    <tr>
                      <th>Id</th>
                      <th>类别</th>
                      <th>标题</th>
                      <th>封面</th>
                      <th>简介</th>
                      <th>内容</th>
                      <th>标签</th>
                      <th>排序</th>
                      <th>置顶</th>
                      <th>热门</th>
                      <th>作者</th>
                      <th>点击量</th>
                      <th>状态</th>
                      <th>操作</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="article:${articles.list}">
                      <td th:utext="${article.id}" class="article_id"></td>
                      <td th:utext="${article.categoryName}" class="article_category_name"></td>
                      <td colspan="1" style="word-wrap:break-word;word-break:break-all;width: 200px" th:title="${article.about}" class="article_title">[[${article.title}]]</td>
                      <td class="article_avatar">
                        <img th:src="${article.avatar}" alt="avatar" style="width: 300px"/>
                      </td>
<!--                      <td th:utext="${article.about}" class="article_about" style="max-width: 300px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap" th:title="${article.about}">-->
<!--                      </td>-->
                      <td  colspan="1" style="word-wrap:break-word;word-break:break-all;width: 200px" th:title="${article.about}" class="article_about">[[${article.about}]]</td>
                      <td >
                        <button id="mainArticle"  type="button" class="btn btn-xs btn-primary article-main" data-toggle="modal" data-target="#mainModal" th:data-whatever="${article.id}">
                          点击查看
                        </button>
                      </td>
                      <td th:utext="${article.tag}" class="article_tag"></td>
                      <td th:utext="${article.articleOrder}" class="article_article_order"></td>
                      <td >
                        <label class="lyear-switch switch-solid switch-cyan">
                          <input class="status" data-type="top" type="checkbox" th:checked="${article.statusTop}" th:value="${article.statusTop}" th:data-id="${article.id}">
                          <span></span>
                        </label>
                      </td>
                      <td>
                        <label class="lyear-switch switch-solid switch-cyan">
                          <input class="status" data-type="hot" type="checkbox" th:checked="${article.statusHot}" th:value="${article.statusHot}" th:data-id="${article.id}">
                          <span></span>
                        </label>
                      </td>
                      <td th:utext="${article.nickName}" class="article_nick_name"></td>
                      <td th:utext="${article.counts}" class="article_counts"></td>
                      <td>
                        <label class="lyear-switch switch-solid switch-cyan">
                          <input class="status" data-type="show" type="checkbox" th:checked="${article.statusShow}" th:value="${article.statusShow}" th:data-id="${article.id}">
                          <span></span>
                        </label>
                      </td>
                      <td>
                        <div class="btn-group">
<!--                          <button type="button" class="btn btn-xs btn-default" data-toggle="modal" data-target="#editModal" data-whatever="编辑" title="编辑"><i class="mdi mdi-pencil"></i></button>-->
                          <button type="button" class="btn btn-xs btn-default delButton" title="删除" th:data-id="${article.id}"><i class="mdi mdi-window-close"></i></button>
                        </div>
                      </td>
                    </tr>
                    </tbody>
                  </table>
                </div>
                <ul class="pagination" >
                  <li class="disabled" th:class="${articles.isFirstPage}?'disabled':''">
                    <a href="#!" th:href="${articles.isFirstPage}?@{'#!'}:@{'/manager/article?pageNum='+${articles.prePage}}">«</a>
                  </li>
                  <li th:each="page:${articles.navigatepageNums}" th:class="${page}==${articles.pageNum}?'active':''">
                    <a href="#!" th:href="@{'/manager/article?pageNum='+${page}}" th:utext="${page}">2</a>
                  </li>
                  <li class="disabled" th:class="${articles.isLastPage}?'disabled':''">
                    <a href="#!" th:href="${articles.isLastPage}?@{'#!'}:@{'/manager/article?pageNum='+${articles.nextPage}}">»</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>

        </div>

      </div>

    </main>
    <!--End 页面主要内容-->
  </div>
</div>

<!-- 详情 模态框-->
<div class="modal fade" id="mainModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
        <h4 class="modal-title" id="myModalLabel">内容</h4>
      </div>
      <div class="modal-body">

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-dismiss="modal">关闭</button>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript" src="../../static/manager/js/jquery.min.js" th:src="@{~/manager/js/jquery.min.js}"></script>
<script type="text/javascript" src="../../static/manager/js/bootstrap.min.js" th:src="@{~/manager/js/bootstrap.min.js}"></script>
<script type="text/javascript" src="../../static/manager/js/perfect-scrollbar.min.js" th:src="@{~/manager/js/perfect-scrollbar.min.js}"></script>
<script type="text/javascript" src="../../static/manager/js/bootstrap-notify.min.js" th:src="@{~/manager/js/bootstrap-notify.min.js}"></script>
<script type="text/javascript" src="../../static/manager/js/lightyear.js" th:src="@{~/manager/js/lightyear.js}"></script>
<script type="text/javascript" src="../../static/manager/js/main.min.js" th:src="@{~/manager/js/main.min.js}"></script>
<script type="text/javascript" th:inline="javascript">
  /*<![CDATA[*/
  $(function(){
    $('#mainModal').on('show.bs.modal', function (event) {
      let button = $(event.relatedTarget);
      let recipient = button.data('whatever');
      let modal = $(this);
      modal.find('.modal-body').text("")
      $.ajax({
        url: '/article/query/'+ recipient,
        type: 'get',
        success:function(res){
          modal.find('.modal-body').append(res.content)
        }
      })
    })

    $('.delButton').unbind('click').on('click',function (){
      lightyear.loading('show');
      let id = $(this).data('id');
      $.ajax({
        url: '/article/del?id='+id,
        type: 'post',
        dataType:'JSON',
        data: JSON.stringify({}),
        contentType: "application/json;charset=UTF-8",
        success:function(res){
          if (res.code === 0){
            window.location.reload();
          }else {
            lightyear.notify('删除失败!', 'danger', 2000, 'mdi mdi-emoticon-happy', 'top', 'center');
          }
          lightyear.loading('hide');
        }
      })
    })

    $('.status').unbind('click').on('click', function(){
      lightyear.loading('show');
      if($(this).val()==='true'){
        $(this).val('false');
      }else {
        $(this).val('true');
      }
      let id = $(this).data('id');
      let type = $(this).data('type');
      let status = $(this).val();
      let data;
      if(type === 'top'){
        data={
          'id': id,
          'statusTop': status
        }
      }else if(type === 'hot'){
        data={
          'id': id,
          'statusHot': status
        }
      }else if(type === 'show'){
        data={
          'id': id,
          'statusShow': status
        }
      }
      $.ajax({
        url: '/article/modify',
        type: 'post',
        dataType:'JSON',
        data: JSON.stringify(data),
        contentType: "application/json;charset=UTF-8",
        success:function(res){
          if (res.code === 0 && res.data > 0){
            lightyear.notify('编辑成功!', 'success', 2000, 'mdi mdi-emoticon-happy', 'top', 'center');
          }else {
            lightyear.notify('编辑失败!', 'danger', 2000, 'mdi mdi-emoticon-happy', 'top', 'center');
            // window.location.reload();
          }
          lightyear.loading('hide');
        }
      })
    })

    $('#addModal').unbind('click').on('click', function(){
      location.href = "/manager/article-add"
    })
  });
  /*]]>*/
</script>
</body>
</html>